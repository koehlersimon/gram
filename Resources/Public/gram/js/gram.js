class Gram{constructor(e){this.defaults={baseUrl:"http://localhost:5757/",galleryUrl:"http://localhost:5757/data/gallery-page-###PAGE###.json",notificationsUrl:"http://localhost:5757/data/notifications.json",notificationInterval:1e4},this.settings=e?Object.assign(this.defaults,e):this.defaults}loadData(e,t){let s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let e=this.responseText;t(e)}4===this.readyState&&404===this.status&&gram.notification("Error loading JSON data from: "+e)},s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send()}loadGalleryItems(e,t,s){console.log(this.settings);var a=this,n=this.settings.galleryUrl.replace("###PAGE###",e);this.loadData(n,(function(e){JSON.parse(e).items.forEach(((e,s)=>{let n=a.galleryItem(e);t.appendChild(n)})),s()}))}showLoader(e){let t=document.getElementById(e),s=document.createElement("div");s.classList.add("spinner-border","text-light","m-auto"),s.innerHTML='<span class="sr-only">Loading...</span>',t.appendChild(s)}hideLoader(e){document.getElementById(e).innerHTML=""}pauseAllVideos(){let e=document.querySelectorAll("video");e&&e.forEach(((e,t)=>{e.pause()}))}buildCommentList(e,t){e.innerHTML="",t.length>0?t.forEach(((t,s)=>{let a=document.createElement("li"),n=document.createElement("strong"),r=document.createElement("p"),i=document.createElement("img");n.innerHTML=t.username,r.innerHTML=t.content,r.prepend(n),a.appendChild(i),a.appendChild(r),i.src=t.avatar,i.width=40,i.height=40,e.appendChild(a)})):e.innerHTML='<li class="alert alert-info m-4">No comments yet. Be the first one to write something!</li>'}resetModal(e){e.querySelector(".username").innerHTML="",e.querySelector(".location").innerHTML="",e.querySelector("textarea").value="",gram.textAreaAdjust(e.querySelector("textarea")),e.querySelector("ul.comments").innerHTML=""}textAreaAdjust(e){e.scrollHeight<300&&(e.style.height="1px",e.style.height=0+e.scrollHeight+"px")}galleryItem(e){let t=document.createElement("div");return t.classList.add("col"),t.innerHTML='<a href="#" data-bs-toggle="modal" data-bs-target="#modal-post" data-bs-postid="'+e.id+'"><div><img src="'+e.thumbnail+'" alt="thumbnail" class="w-100 h-100"></div><div class="overlay"><i class="fa fa-heart"></i> '+e.likecount+' <i class="fa fa-comment"></i> '+e.commentcount+"</div></a>",t}notification(e){var t=document.getElementById("liveToast"),s=new bootstrap.Toast(t);t.querySelector(".toast-body").innerHTML=e,s.show()}initStyles(){let e=document.getElementById("styles");"light"===gram.getCookie("currentstyle")?e.href="css/styles.css":"dark"===gram.getCookie("currentstyle")&&(e.href="css/styles-dark.css")}toggleStyles(){let e=document.getElementById("styles");"light"===gram.getCookie("currentstyle")?(e.href="css/styles-dark.css",gram.setCookie("currentstyle","dark",10)):(gram.getCookie("currentstyle"),e.href="css/styles.css",gram.setCookie("currentstyle","light",10))}setCookie(e,t,s){const a=new Date;a.setTime(a.getTime()+24*s*60*60*1e3);let n="expires="+a.toUTCString();document.cookie=e+"="+t+";"+n+";path=/"}getCookie(e){let t=e+"=",s=document.cookie.split(";");for(let e=0;e<s.length;e++){let a=s[e];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}updateNotifications(){const e=document.querySelector(".dropdown-menu-likes");e&&(e.innerHTML="",gram.loadData(this.settings.notificationsUrl,(function(t){JSON.parse(t).notifications.forEach(((t,s)=>{var a=document.createElement("li");a.innerHTML='<img src="'+t.avatar+'" class="avatar" width="24" height="24" alt="'+t.username+'"><div class="px-2"><a href="profile.html"><strong>'+t.username+"</strong></a> "+t.message+' <span class="text-muted">'+t.time+'</span></div><img src="'+t.avatar+'" class="ms-auto" width="40" height="40" alt="'+t.username+'">',e.appendChild(a)}))})))}}