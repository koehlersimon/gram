class Gram{constructor(t){this.defaults={baseUrl:"http://localhost:5757/",galleryUrl:"http://localhost:5757/data/gallery-page-###PAGE###.json",postUrl:"http://localhost:5757/data/post-###POST###.json",commentsUrl:"http://localhost:5757/data/post-###POST###-comments.json",notificationsUrl:"http://localhost:5757/data/notifications.json",notificationInterval:1e4},this.settings=t?Object.assign(this.defaults,t):this.defaults}loadData(t,e){let a=new XMLHttpRequest;a.open("GET",t,!0),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let t=this.responseText;e(t)}4===this.readyState&&404===this.status&&gram.notification("Error loading JSON data from: "+t)},a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send()}loadGalleryItems(t,e,a){console.log(this.settings);var s=this,n=this.settings.galleryUrl.replace("###PAGE###",t);this.loadData(n,(function(t){JSON.parse(t).items.forEach(((t,a)=>{let n=s.galleryItem(t);e.appendChild(n)})),a()}))}showLoader(t){let e=document.getElementById(t),a=document.createElement("div");a.classList.add("spinner-border","text-light","m-auto"),a.innerHTML='<span class="sr-only">Loading...</span>',e.appendChild(a)}hideLoader(t){document.getElementById(t).innerHTML=""}pauseAllVideos(){let t=document.querySelectorAll("video");t&&t.forEach(((t,e)=>{t.pause()}))}buildCommentList(t,e){t.innerHTML="",e.length>0?e.forEach(((e,a)=>{let s=document.createElement("li"),n=document.createElement("strong"),r=document.createElement("p"),o=document.createElement("img");n.innerHTML=e.username,r.innerHTML=e.content,r.prepend(n),s.appendChild(o),s.appendChild(r),o.src=e.avatar,o.width=40,o.height=40,t.appendChild(s)})):t.innerHTML='<li class="alert alert-info m-4">No comments yet. Be the first one to write something!</li>'}resetModal(t){t.querySelector(".username").innerHTML="",t.querySelector(".location").innerHTML="",t.querySelector("textarea").value="",gram.textAreaAdjust(t.querySelector("textarea")),t.querySelector("ul.comments").innerHTML=""}textAreaAdjust(t){t.scrollHeight<300&&(t.style.height="1px",t.style.height=0+t.scrollHeight+"px")}galleryItem(t){let e=document.createElement("div");return e.classList.add("col"),e.innerHTML='<a href="#" data-bs-toggle="modal" data-bs-target="#modal-post" data-bs-postid="'+t.id+'"><div><img src="'+t.thumbnail+'" alt="thumbnail" class="w-100 h-100"></div><div class="overlay"><i class="fa fa-heart"></i> '+t.likecount+' <i class="fa fa-comment"></i> '+t.commentcount+"</div></a>",e}notification(t){var e=document.getElementById("liveToast"),a=new bootstrap.Toast(e);e.querySelector(".toast-body").innerHTML=t,a.show()}initStyles(){let t=document.getElementById("styles"),e=t.getAttribute("data-light"),a=t.getAttribute("data-dark");"light"===gram.getCookie("currentstyle")?t.href=e:"dark"===gram.getCookie("currentstyle")&&(t.href=a)}toggleStyles(){let t=document.getElementById("styles"),e=t.getAttribute("data-light"),a=t.getAttribute("data-dark");"light"===gram.getCookie("currentstyle")?(t.href=a,gram.setCookie("currentstyle","dark",10)):(gram.getCookie("currentstyle"),t.href=e,gram.setCookie("currentstyle","light",10))}setCookie(t,e,a){const s=new Date;s.setTime(s.getTime()+24*a*60*60*1e3);let n="expires="+s.toUTCString();document.cookie=t+"="+e+";"+n+";path=/"}getCookie(t){let e=t+"=",a=document.cookie.split(";");for(let t=0;t<a.length;t++){let s=a[t];for(;" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(e))return s.substring(e.length,s.length)}return""}updateNotifications(){const t=document.querySelector(".dropdown-menu-likes");t&&(t.innerHTML="",gram.loadData(this.settings.notificationsUrl,(function(e){JSON.parse(e).notifications.forEach(((e,a)=>{var s=document.createElement("li");s.innerHTML='<img src="'+e.avatar+'" class="avatar" width="24" height="24" alt="'+e.username+'"><div class="px-2"><a href="profile.html"><strong>'+e.username+"</strong></a> "+e.message+' <span class="text-muted">'+e.time+'</span></div><img src="'+e.avatar+'" class="ms-auto" width="40" height="40" alt="'+e.username+'">',t.appendChild(s)}))})))}}